<div class="reports-container">
  <!-- Main Content Panel -->
  <div class="report-panel" #reportContent>
    <!-- Filter Section -->
    <div class="filter-section">
      <label class="filter-label">FILTER BY MONTH:</label>
      <mat-form-field appearance="outline" class="filter-select">
        <mat-select [formControl]="monthFilter">
          <mat-option *ngFor="let month of availableMonths" [value]="month.value">
            {{ month.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <span class="selected-month-display">{{ getSelectedMonthLabel() }}</span>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container" fxLayout="column" fxLayoutAlign="center center">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Loading report data...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-container">
      <mat-icon color="warn">error</mat-icon>
      <p>{{ error }}</p>
      <button mat-raised-button color="primary" (click)="loadReportData()">Retry</button>
    </div>

    <!-- Report Content -->
    <div *ngIf="!loading && !error && reportData" class="report-content-wrapper" fxLayout="row" fxLayout.xs="column" fxLayout.sm="column" fxLayoutGap="24px">
      <!-- Left Side: Tables -->
      <div class="tables-section" fxFlex="1 1 50%" fxFlex.xs="100" fxFlex.sm="100">
        <!-- Summary Table -->
        <div class="table-container">
          <table class="report-table">
            <thead>
              <tr>
                <th>Metric</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Total CBU Built</td>
                <td>{{ summary.totalUnits }}</td>
              </tr>
              <tr>
                <td>Total CBU Delivered</td>
                <td>{{ summary.deliveredUnits }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Model-wise Units Table -->
        <div class="table-container">
          <table class="report-table">
            <thead>
              <tr>
                <th>Model</th>
                <th>Units Built</th>
                <th>Units Delivered</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of modelData">
                <td>{{ item.modelName }}</td>
                <td>{{ item.totalUnits }}</td>
                <td>{{ item.deliveredUnits }}</td>
              </tr>
              <tr *ngIf="modelData.length === 0">
                <td colspan="3" class="no-data">No data available</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Color-wise Units Table -->
        <div class="table-container">
          <table class="report-table">
            <thead>
              <tr>
                <th>Color</th>
                <th>Units Built</th>
                <th>Units Delivered</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of colorData">
                <td>{{ item.color }}</td>
                <td>{{ item.totalUnits }}</td>
                <td>{{ item.deliveredUnits }}</td>
              </tr>
              <tr *ngIf="colorData.length === 0">
                <td colspan="3" class="no-data">No data available</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Right Side: Chart and Export -->
      <div class="chart-export-section" fxFlex="1 1 50%" fxFlex.xs="100" fxFlex.sm="100">
        <!-- Bar Chart -->
        <div class="chart-container">
          <div class="chart-wrapper">
            <apx-chart
              #chart
              [series]="chartOptions.series"
              [chart]="chartOptions.chart"
              [dataLabels]="chartOptions.dataLabels"
              [plotOptions]="chartOptions.plotOptions"
              [xaxis]="chartOptions.xaxis"
              [yaxis]="chartOptions.yaxis"
              [legend]="chartOptions.legend"
              [fill]="chartOptions.fill"
              [tooltip]="chartOptions.tooltip"
              [colors]="chartOptions.colors">
            </apx-chart>
          </div>
        </div>

        <!-- Export Button -->
        <div class="export-section">
          <button mat-raised-button color="primary" class="export-button" (click)="exportToPDF()" [disabled]="loading">
            <mat-icon>file_download</mat-icon>
            EXPORT
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

