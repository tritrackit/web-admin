<mat-toolbar color="#fff" class="mat-elevation-z4">
  <button [disabled]="isLoading" style="margin-right: 10px!important;" mat-icon-button
    matTooltip="{{ isReadOnly? 'Back' : 'Cancel'}}"
    [routerLink]="isReadOnly ? '/scanner/' : isNew ? '/scanner/': '/scanner/' + scannerCode">
    <mat-icon>
      {{
      isReadOnly? 'keyboard_arrow_left' : 'close'
      }}
    </mat-icon>
  </button>
  <span id="title">
    <span [ngStyle.md]="{ 'display': 'none'}" [ngStyle.sm]="{ 'display': 'none'}" [ngStyle.xs]="{ 'display': 'none'}">
      {{ isNew ? 'New Scanner' : '#' + scannerCode + ' ' + ( !isLoading ? scanner?.name : '')}}
    </span>
  </span>
  <span class="toolbar-item-spacer"></span>
  <div class="toolbar-action">
    <button *ngIf="!isNew && isReadOnly" mat-raised-button color="primary" matTooltip="Delete"
      (click)="onDeleteProduct()">
      Delete
    </button>
    <button mat-raised-button color="primary" matTooltip="Edit" *ngIf="!isNew && isReadOnly"
      routerLink="/scanner/{{scannerCode}}/edit" replaceUrl="true">
      Edit
    </button>
    <button *ngIf="!isReadOnly" mat-raised-button color="primary" matTooltip="{{isNew ? 'Save' : 'Update'}}"
      [disabled]="!formIsReady || !formIsValid" form="scannerForm" type="submit">
      {{isNew ? 'Save' : 'Update'}}
    </button>
  </div>
</mat-toolbar>
<div class="content">
  <div class="inner-content">
    <h4 class="inner-content-title">Product details</h4>
    <mat-card>
      <mat-card-content>
        <div fxLayout="column" fxLayoutGap="16px">
          <div fxFlex="100" class="content-inner" fxLayout="column">
            <form [formGroup]="scannerForm" fxLayout="row wrap" id="scannerForm" (ngSubmit)="onSubmit()"
              [ngClass]="{'readonly' : isReadOnly}">
              <fieldset fxFlex="100" fxLayout="row wrap" style="row-gap: 16px">
                <div fxFlex="100" fxLayout="column" fxLayout.gt-sm="row" style="gap: 16px">
                  <mat-form-field appearance="outline" fxFlex.gt-sm="50%" fxFlex="100" class="cell"
                    [ngClass.gt-sm]="{ isLargeScreen: true }">
                    <mat-label>Scanner Code</mat-label>
                    <input [readonly]="!isNew" matInput placeholder="Scanner code" formControlName="scannerCode" />
                    <mat-error *ngIf="getError('scannerCode')">
                      {{
                      (getError("scannerCode") &&
                      getError("scannerCode")["required"]
                      ? "Please enter scanner code"
                      : "")
                      }}
                      {{
                      (getError("scannerCode") &&
                      getError("scannerCode")["exist"]
                      ? error
                      : "")
                      }}
                      {{
                      (getError("scannerCode") &&
                      getError("scannerCode")["minlength"]
                      ? "ScannerCode must be at least 3 characters"
                      : "")
                      ||
                      (getError("scannerCode") &&
                      getError("scannerCode")["maxlength"]
                      ? "ScannerCode must not exceed 15 characters"
                      : "")
                      ||

                      (getError("scannerCode") &&
                      getError("scannerCode")["pattern"]
                      ? error ?? "Invalid value, scanner code must start with an uppercase letter or a number, and only contain letters, numbers, underscore (_) or dash (-) with no spaces, max 15 characters"
                      : "")
                      }}
                      </mat-error>
                  </mat-form-field>
                  <mat-form-field appearance="outline" fxFlex.gt-sm="50%" fxFlex="100" class="cell"
                    [ngClass.gt-sm]="{ isLargeScreen: true }">
                    <mat-label>Name</mat-label>
                    <input matInput placeholder="Name" formControlName="name" />
                    <mat-error *ngIf="getError('name')">{{
                      (getError("name") &&
                      getError("name")["required"]
                      ? "Please enter name"
                      : "")
                      }}
                      {{
                      (getError("name") &&
                      getError("name")["exist"]
                      ? error
                      : "")
                      }}</mat-error>
                  </mat-form-field>
                </div>

                <div fxLayout="column" fxLayout.gt-sm="row" fxFlex="100" class="content-inner"
                  [ngClass]="{'readonly' : isReadOnly}">
                  <mat-form-field class="example-full-width" appearance="outline" fxFlex.gt-sm="33.33%" fxFlex="100"
                    style="position: relative!important;">
                    <mat-label>{{isNew ? 'Location' : 'Current location'}}</mat-label>
                    <input type="text" placeholder="Select location" aria-label="Select location" matInput
                      [formControl]="locationSearchCtrl" [matAutocomplete]="autoLocation" [readonly]="!isNew"
                      (focusout)="mapSearchLocation();" #locationSearchInput (input)="isOptionsLocationLoading = true;">
                    <mat-autocomplete #autocompleteLocation #autoLocation="matAutocomplete"
                      [displayWith]="displayLocationName"
                      (optionSelected)="onLocationSelected($event.option.value)">
                      <mat-option *ngFor="let option of optionsLocation" [value]="option.code">
                        {{option.name}}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="getError('locationId') || locationSearchCtrl.errors">
                      {{
                      (getError("locationId") && getError("locationId").required
                      ? "Please select location"
                      : "") ||
                      (locationSearchCtrl.errors && locationSearchCtrl.errors.required
                      ? "Please select location"
                      : "")
                      }}
                    </mat-error>
                    <mat-spinner *ngIf="isOptionsLocationLoading"></mat-spinner>
                  </mat-form-field>
                </div>

                <div fxLayout="column" fxLayout.gt-sm="row" fxFlex="100" class="content-inner"
                  [ngClass]="{'readonly' : isReadOnly}">
                  <mat-form-field class="example-full-width" appearance="outline" fxFlex="100"
                    style="position: relative!important;">
                    <mat-label>Assigned Employee</mat-label>
                    <input type="text" placeholder="Select Assigned Employee" aria-label="Select Assigned Employee" matInput
                      [formControl]="assignedEmployeeUserSearchCtrl" [matAutocomplete]="autoAssignedEmployeeUser"
                      (focusout)="mapSearchAssignedEmployeeUser();" #assignedEmployeeUserSearchInput (input)="isOptionsAssignedEmployeeUserLoading = true;">
                    <mat-autocomplete #autocompleteAssignedEmployeeUser #autoAssignedEmployeeUser="matAutocomplete"
                      [displayWith]="displaymapSearchAssignedEmployeeUser"
                      (optionSelected)="onAssignedEmployeeUserSelected($event.option.value)">
                      <mat-option *ngFor="let option of optionsAssignedEmployeeUser" [value]="option.code">
                        {{option.name}}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="getError('assignedEmployeeUserId') || assignedEmployeeUserSearchCtrl.errors">
                      {{
                      (getError("assignedEmployeeUserId") && getError("assignedEmployeeUserId").required
                      ? "Please select Assigned Employee"
                      : "") ||
                      (assignedEmployeeUserSearchCtrl.errors && assignedEmployeeUserSearchCtrl.errors.required
                      ? "Please select Assigned Employee"
                      : "")
                      }}
                    </mat-error>
                    <mat-spinner *ngIf="isOptionsAssignedEmployeeUserLoading"></mat-spinner>
                  </mat-form-field>
                </div>

                <div fxFlex="100" fxLayout="column" fxLayout.gt-sm="row" style="gap: 16px">
                  <mat-form-field fxFlex="100" fxFlex.gt-sm="50" fxLayout="column" appearance="outline">
                    <mat-label>Scanner status</mat-label>
                    <mat-select formControlName="statusId">
                      <mat-option value="1">REGISTERED</mat-option>
                      <mat-option value="2">STORAGE</mat-option>
                      <mat-option value="3">READY</mat-option>
                      <mat-option value="4">HOLD</mat-option>
                      <mat-option value="5">DELIVERED</mat-option>
                      <mat-option value="6">CLOSED</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </fieldset>
            </form>

          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
